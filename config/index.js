// Generated by CoffeeScript 1.9.2
(function() {
  var _, _log, config, fileExists, fs, path;

  fs = require('fs');

  path = require('path');

  _ = require('lodash');

  config = require('./default');

  _log = console.log;

  fileExists = function(filepath) {
    var e;
    try {
      fs.statSync(filepath);
    } catch (_error) {
      e = _error;
      return false;
    }
    return true;
  };

  module.exports = function() {
    var configDir, env, envPath, execDir, ref, ref1;
    env = (ref = process.env.npm_config_env) != null ? ref : 'container';
    configDir = (ref1 = process.env.npm_config_config_dir) != null ? ref1 : 'src/config';
    execDir = process.cwd();
    _log('Environment specified:', env);
    _log('Config Dir specified:', configDir);
    if (configDir) {
      envPath = path.join(execDir, configDir, env + '.js');
      _log('Env Config Path:', envPath);
    }
    if (fileExists(envPath)) {
      _log('Environment configuration found:', envPath);
      _.merge(config, require(envPath));
    } else {
      _log('Environment specific configuration file not loaded. Using default configuration.');
    }
    config.env = env;
    config.processDir = execDir;
    return config;
  };

}).call(this);
